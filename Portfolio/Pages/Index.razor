@page "/"

@using Portfolio.Client
@using Portfolio.Model.Text

@inject AppState AppState
@inject LightboxRegistry LightboxRegistry
@inject LanguageTable LanguageTable

<PageIsland IslandTitle="Projects" id="projects">
    <ChildContent>
        <Carousel FromJsonFile="./ProjectData/Projects.json"
                  DelayAmount="7000"
                  StartIdx="1"/>
    </ChildContent>
</PageIsland>

<PageIsland IslandTitle="About Me" id="about">
    <ChildContent>
        <TwoView FlexValues="@(new ValueTuple<string, string>("2 2 300px", "1 0"))">
            <FirstView>
                <section style="font-size: 1.1rem;">
                    <p>
                        Ik ben Mitchel Vonk, geboren te Beverwijk en wonend in Heemskerk. Ik vind programmeren in C#
                        erg leuk
                        en fijn (deze portfolio is gemaakt in blazor pages)! Ik leer er dagelijks nieuwe dingen in.
                    </p>
                    <hr/>
                    <p>
                        Ik programmeer al sinds begin 2019 met JavaScript in de browser. Ik was voornamelijk begonnen om
                        wiskundige formules uit te werken (ik heb alijd al van wiskunde gehouden).
                        Ook heb ik kleine spelletjes gemaakt in JavaScript in de browser, en was ik begonnen met het
                        maken van Console-applications in Python
                    </p>
                    <hr/>
                    <p>
                        Toen ik in 2021 mijn Havo met succes afrondde, begon ik aan mijn vervolg-opleiding: Software Developer
                        aan het Mediacollege Amsterdam. In het eerste halfjaar van jaar één hebben we daar met Python gewerkt.
                        Aan het einde van dit halve jaar, kregen we de keuze of we Media-Developer wilde worden of Game-Developer.
                        Toen heb ik de keuze gemaakt voor Game-Developer.
                    </p>
                    <hr/>
                    <p>
                        Naast programmeren ga ik graag om met vrienden, welke voort zijn gekomen uit een hechte groep die was
                        gevormd aan het begin van mijn middelbare school periode. Ook sport ik erg graag en heb ik ook al redelijk
                        wat beoefend: skiën, schaatsen en snowboarden. En ga ik wekelijks naar de sportschool.
                    </p>
                </section>
            </FirstView>
            <SecondView>
                <article class="two-view__img-article sticky">
                    <LightboxImg
                        BoundLightboxName="Welkom Lightbox"
                        Registry="LightboxRegistry"
                        class="hover-scale sc075"
                        src="./images/AboutMeCropped.webp"
                        alt="Foto van mij op wintersport"
                        height="465" />
                </article>
            </SecondView>
        </TwoView>
    </ChildContent>
</PageIsland>

<PageIsland IslandTitle="Contact Me" id="contact">
    <ChildContent>
        <div style="display: flex; margin-top: 2rem;">
            <section
                style="
                width: 100%;
                max-width: var(--content-max-width-xs);
                margin: 0 auto;
                display: flex;
                flex-wrap: wrap;
                justify-content: space-evenly;">

                <a class="contact-link hover-scale"
                   href="https://www.linkedin.com/in/mitchel-vonk-87155024b/"
                   target="_blank"
                   style="flex-basis: 150px;">
                    <i class="bi bi-linkedin"
                       style="font-size: 4rem; color:  var(--accent-colour);">
                    </i> 
                    <span>LinkedIn</span>
                </a>

                <a class="contact-link hover-scale"
                   href="https://github.com/MitchelMA"
                   target="_blank"
                   style="flex-basis: 150px;">
                    <i class="bi bi-github"
                       style="font-size: 4rem; color: var(--accent-colour);">
                    </i>
                    <span>GitHub</span>
                </a>

                <a class="contact-link hover-scale"
                   href="mailto:vonkm124@gmail.com?SUBJECT=Reagerend%20op%20Portfolio"
                   target="_blank"
                   style="flex-basis: 150px;">
                    <i class="bi bi-mailbox2"
                       style="font-size: 4rem; color:  var(--accent-colour);">
                    </i>
                    <span>E-mail</span>
                </a>
            </section>
        </div>
    </ChildContent>
</PageIsland>

<Lightbox LightboxName="Welkom Lightbox"
          Registry="LightboxRegistry"/>

@code {

    private static NavLinkData[]? _links;

    private static readonly LinkTag PageIcon = new PageIcon("image/webp", "./images/AboutMeCroppedHead.webp");

    private static HeaderData _headerData = new()
    {
        ImagePath = StaticData.MainHeaderImgPath,
    };

    protected override async Task OnInitializedAsync()
    {
        AppState.PageTitleExtension = string.Empty;
        AppState.PageIcon = PageIcon;
        
        await LoadContent();
    }

    private async Task LoadContent()
    {
        if (LanguageTable.IsLoaded)
        {
            await SetLangData();
            return;
        }

        LanguageTable.ManifestLoadedAsync += OnManifestLoaded;
    }

    private async Task SetLangData()
    {
        var currentData = await LanguageTable.LoadAllCurrentPageData();
        if (currentData is null)
        {
            AppState.HeaderData = _headerData;
            await Console.Error.WriteLineAsync("Couldn't get Page Data in specified language!");
            return;
        }
        
        SetPageContent(currentData);
        LanguageTable.ManifestLoadedAsync -= OnManifestLoaded;
    }

    private void SetPageContent(LangPageData langPageData)
    {
        SetHeaderData(langPageData.HeaderData!.Value);
        SetLinksData(langPageData!.LinksData!.Value); 
    }

    private void SetHeaderData(LangHeaderModel headerData)
    {
        _headerData.Title = headerData.Title;
        _headerData.UnderTitle = headerData.UnderTitle;
        _headerData.Description = headerData.Description;
        AppState.PageTitleExtension = " " + headerData.PageTitleExtension;
        AppState.HeaderData = _headerData;
    }

    private void SetLinksData(LangLinksModel linksData)
    {
        _links = new NavLinkData[linksData.Links.Length];
        for (var i = 0; i < linksData.Links.Length; i++)
        {
            var cur = linksData.Links[i];
            _links[i] = new NavLinkData(cur.Href, cur.DisplayText, cur.OpensNew);
        }

        AppState.Links = _links;
        AppState.MinNonStackedSize = linksData.MinWidth;
    }

    private async Task OnManifestLoaded(object? sender) =>
        await SetLangData();

}